# Chapter 01
## An introduction to web apps
---
- web app - consists of a set of web pages that are generated by user requests
---
- Web apps consist of clients and a web server
- Clients often access web pages via a web browser. Web server stores all the files that generate the pages of a web app
- network connects the clients to the web server
- to request a page from a web server, the user types in the address of a web page into the web browser
- URL consists of protocol, domain name, path, and filename. HTTPS is assumed in most cases
- LAN connects computers that are near each other.
- WAN consists of two or more LANs
- cloud refers to software and services that run on the internet
- ISP owns a WAN connected to the Internet
---
## How static web pages are processed
- HTML: used to define the pages of a web app
- static web page: built from HTML file
- when web page is requested, browser sends an HTTP request to the server that includes the name of the file that is being requested
 - when server receives request, it sends back the requested files as part of an HTTP response
 - browser then renders the response into a web page that is displayed to the user
 ---
 ## How dynamic web pages are processed
 - dynamic web page is a web page generated by a program running on a web server
 - when a request is received for a dynamic web page, the web server looks for the appropriate application server in order to properly process the file
 - typically data from a database is requested
 - once the data is finished processing, the html, css, and javascript is returned to the web server, and then sent to the user via a HTTP response
 - round trip: describes the process in which the above occurs
 - Kestrel: cross platform web server that functions as app server for .NET Core
 - IIS: Windows only app server for ASP.NET apps
 - SQL Server: database server for .NET Core and .NET apps
 ---
 ## An intro to the MVC pattern
 ### Components
 - model: consists of the code that provides data access and the business logic
 - view: code that makes up the user interface shown to the end user
 - controller: code that receives requests from users, gets appropriate data, and stores in model,
 ### Benefits
 - makes it easier to split workloads across teams
 - makes it possible for automated testing of individual components
 - makes it possible to swap components
 - app is easier to maintain
 ### Drawbacks
 - more work to set up
 ---
 ## An introduction to .NET Core MVC
 ### 3 Models for web apps in .NET
 1. ASP.NET Web Forms
- Released in 2002
- provides rapid app development by letting devs build pages similar to Windows Forms
- problems include poor performance, improper separation of concerns, lack of support for automated testing, and limited control over front end returned to the browser
- Uses .NET framework, proprietary to the Windows Operating System
 2. ASP.NET MVC
- Released in 2007
- uses MVC pattern that is used by other web dev platforms
- fixes many issues to provide better performance, separation of concerns, support for automated testing, and better control of front end
- still proprietary to Windows
 3. ASP.NET Core MVC
- released in 2015
- uses a service to implement MVC pattern that is used by other web dev platforms
- provides all functionality of MVC with better performance, more modularity, and cleaner code
- built on .NET Core, which is multi platform and can run on Windows, macOS, and Linux.
---
## Some web components of .NET and .NET Core
- .NET Framework
- .NET Core
- ASP.NET Web Forms use services of the .NET Framework
- .NET MVC work by using services of the .NET Framework
- .NET Core MVC use services of .NET Core
---
## An intro to .NET Core middleware
### Middleware can
- generate content for a response
- edit content of a response
- edit content of a request
- short circuit a request
---
## How state works in a web app
- state refers to the current status of properties, variables, and other data for a single user
- HTTP is a stateless protocol. It does not keep track of states in between round trips
- .NET Web Forms used to automatically maintain state, leading to poor performance
- .NET Core provides features to handle state in a way that developers control each request and response
---
## How .NET Core MVC apps work
- MVC uses design paradigm called convention over configuration, which reduces developer configuration for a project.
- top level folder is called the root directory
- c# classes are used to define controllers and models
- razor views are used to define views
- static files include css libraries, javascript libraries, custom css and javascript 
### Some naming conventions
- All controllers should be stored in a folder named controllers or a subfolder
- all models should be stored in a models directory
- view files should be in view directory
- static files such as images, css and javascript should be in wwwroot directory
- controller classes should have a "Controller" suffix
---
## How a controller passes a model to a view
- model is a c# class that defines the data objects and business rules for app
- .Net Core Controller inherits `Microsoft.AspNetCore.Mvc.Controller` class
- an action is a method of controller that returns an action result
- action method can use the View() method to return a type of action result known as a view result that is created by merging the model into the corresponding view file
### code for a model class named Product
    namespace GuitarShop.Models
    {
        public class Product
        {
            public int ProductID { get; set; }
            public string Name { get; set; }
            public decimal Price { get; set; }
            public string Slug => Name.Replace(' ', '-');
        }
    }
### code for a controller class named ProductController
    using Microsoft.AspNetCore.Mvc;
    using System.Collections.Generic;
    using GuitarShop.Models;

    namespace GuitarShop.Controllers
    {
        public class ProductController : Controller
        {
            public IActionResult Detail(string id)
            {
                Product product = DB.GetProduct(id);
                return View(product); // passes model to Product/Detail view
            }

            public IActionResult List()
            {
                List<Product> products = DB.GetProducts();
                return View(products); // passes model to Product/List view
            }
        }
    }
---
## How a view uses Razor code, tag helpers, and Bootstrap CSS classes
- Most of a typical view file consists of standard HTML elements
- the @model directive specifies the class for the model, and the @Model property allows you to access the model object that's passed on to the view from the controller
- the @ sign followed by braces ({}) identifies a block of C# statements. Within the block, you can code one or more C# statements
- All HTML attributes that begin with "asp-" are tag helpers. Defined by C# classes and make it easier to work with HTML elements.
- the class attribute of an HTML element can specify CSS classes from Bootstrap
### code for a view file named Product/Detail.cshtml
    @model Product
    @{
        View Bag.Title = "Product Detail";
    }
    <h1>Product Detail</h1>
    <table class="table table-bordered table-striped">
        <tr>
            <td>ID</td><td>@Model.ProductID</td>
        </tr>
        <tr>
            <td>Name</td><td>@Model.Name</td>
        </tr>
        <tr>
            <td>Price</td><td>@Model.Price.ToString("C2")</td>
        </tr>
    </table>
    <a asp-controller="Home" asp-action="Index" class="btn btn-primary">Home</a>
---
## How the Startup.cs file configures the middleware for an app
- the Startup.cs file contains the code that configures the middleware that's used by the app
- The ConfigureServices() method contains the code that adds services to the app
- the Configure() method contains the code that identifies which services to use and provides additional configuration if necessary
- By convention, the routing system identifies the Home controller as the default controller and the Index() action method as the default action
### Startup.cs file code
    using Microsoft.AspNetCore.Builder;
    using Microsoft.Extensions.DependencyInjection;

    namespace GuitarShop
    {
        public class Startup
        {
            public void ConfigureServices(IServiceCollection services)
            {
                services.AddControllerWithViews();

            }

            public void Configure(IApplicationBuilder app)
            {
                app.UseDeveloperExceptionPage();
                app.UseStaticFiles();
                app.UseRouting();
                app.UseEndpoints(endpoints =>
                {
                    endpoints.MapControllerRout(
                        name: "default",
                        pattern: "{controller=Home}/{action=Index}/{id?}");
                });
            }
        }
    }